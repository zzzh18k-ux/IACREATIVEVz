<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Casino 777 Free</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src='//libtl.com/sdk.js' data-zone='10278425' data-sdk='show_10278425'></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        body { font-family: 'Montserrat', sans-serif; background-color: #0f172a; color: white; -webkit-tap-highlight-color: transparent; user-select: none; }
        .font-bebas { font-family: 'Bebas Neue', cursive; }
        .hidden { display: none !important; }
        .locked { opacity: 0.5; pointer-events: none; filter: grayscale(1); }
        .icon-glow { filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.5)); }
        @keyframes flip-coin { 0% { transform: rotateY(0); } 100% { transform: rotateY(720deg); } }
        .animate-flip { animation: flip-coin 0.6s ease-out; }
    </style>
</head>
<body class="bg-slate-950 pb-20">

    <audio id="snd-click" src="https://cdn.pixabay.com/audio/2022/03/15/audio_c8c8a73467.mp3" preload="auto"></audio>
    <audio id="snd-win" src="https://cdn.pixabay.com/audio/2021/08/04/audio_0625c1539c.mp3" preload="auto"></audio>
    <audio id="snd-coin" src="https://cdn.pixabay.com/audio/2022/01/18/audio_d0a13f69d2.mp3" preload="auto"></audio>

    <div class="px-5 py-4 bg-slate-900/90 backdrop-blur-md sticky top-0 z-50 border-b border-white/5 flex flex-col gap-3 shadow-lg">
        <div class="flex justify-between items-center">
            <div class="flex flex-col">
                <span class="text-[9px] text-slate-400 font-bold uppercase tracking-wider">Tu Balance</span>
                <div class="flex items-center gap-2">
                    <i class="fas fa-wallet text-emerald-400 text-sm"></i>
                    <span class="text-2xl font-black text-white font-bebas tracking-wide" id="display-balance">$0.0000</span>
                </div>
            </div>
            <button onclick="intentarRetiro()" class="px-4 py-2 rounded-lg font-bold text-[10px] uppercase bg-slate-800 text-slate-400 border border-white/5 active:bg-slate-700 transition-all">
                <i class="fas fa-money-bill-transfer mr-1"></i> Retirar
            </button>
        </div>
        <div class="w-full bg-slate-800 rounded-full h-1.5 overflow-hidden">
            <div id="progress-bar" class="h-full bg-gradient-to-r from-emerald-500 to-teal-400 transition-all duration-500" style="width: 0%"></div>
        </div>
        <div class="text-center text-[8px] text-slate-500 uppercase font-bold">
            M√≠nimo para retirar: $<span id="min-withdraw-display">0.50</span>
        </div>
    </div>
    <div class="px-4 py-4 max-w-md mx-auto space-y-4">
        <div id="game-msg" class="hidden p-3 rounded-xl text-center font-bold text-sm mb-2 border animate-pulse flex items-center justify-center gap-2"></div>

        <div id="view-menu" class="space-y-3">
            <button onclick="claimDailyBonus()" id="btn-daily" class="w-full p-4 rounded-2xl flex items-center justify-between border border-white/5 bg-gradient-to-r from-slate-900 to-slate-800 shadow-md active:scale-[0.98] transition-all">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-yellow-500/10 flex items-center justify-center text-yellow-500 border border-yellow-500/20">
                        <i class="fas fa-gift text-lg" id="daily-icon"></i>
                    </div>
                    <div class="text-left">
                        <p class="font-bold text-[10px] text-slate-400 uppercase" id="daily-label">Bono Diario</p>
                        <p class="font-bebas text-xl text-white" id="daily-text">Cargando...</p>
                    </div>
                </div>
                <i class="fas fa-chevron-right text-xs text-slate-600"></i>
            </button>

            <button onclick="openTeam()" class="w-full py-3 px-4 rounded-xl bg-slate-800/50 border border-white/5 text-slate-300 font-bold text-[10px] uppercase flex items-center justify-between active:bg-slate-800">
                <span class="flex items-center gap-2"><i class="fas fa-users text-blue-400"></i> Equipo (10% Ganancia)</span>
                <i class="fas fa-arrow-right text-slate-600"></i>
            </button>

            <h2 class="font-bebas text-lg text-slate-500 tracking-widest pl-1 mt-4">CASINO</h2>
            <div class="grid grid-cols-2 gap-3">
                <button onclick="openGame('mines')" class="h-28 bg-gradient-to-br from-red-600/90 to-red-800/90 rounded-2xl p-4 flex flex-col justify-between border border-white/10 shadow-lg relative overflow-hidden active:scale-[0.98] transition-all">
                    <i class="fas fa-bomb text-4xl text-white/20 absolute -bottom-2 -right-2"></i>
                    <i class="fas fa-bomb text-2xl text-white mb-2 icon-glow"></i>
                    <div class="text-left relative z-10"><p class="font-bebas text-2xl leading-none">MINAS</p></div>
                </button>
                <button onclick="openGame('coin')" class="h-28 bg-gradient-to-br from-blue-600/90 to-blue-800/90 rounded-2xl p-4 flex flex-col justify-between border border-white/10 shadow-lg relative overflow-hidden active:scale-[0.98] transition-all">
                    <i class="fas fa-coins text-4xl text-white/20 absolute -bottom-2 -right-2"></i>
                    <i class="fas fa-circle-dollar-to-slot text-2xl text-white mb-2 icon-glow"></i>
                    <div class="text-left relative z-10"><p class="font-bebas text-2xl leading-none">MONEDA</p></div>
                </button>
            </div>

            <div class="bg-slate-900/50 p-4 rounded-2xl border border-white/5 mt-4">
                <div class="flex items-center gap-2 mb-3 justify-center text-slate-500">
                    <i class="fas fa-play-circle text-xs"></i><p class="text-[9px] font-black uppercase tracking-widest">VIDEOS (+0.0020)</p>
                </div>
                <div class="grid grid-cols-4 gap-2" id="video-grid"></div>
                <p class="text-[8px] text-slate-600 text-center mt-2">Se reinician a las 24 horas.</p>
            </div>
        </div>
        <div id="view-team" class="hidden space-y-4">
            <div class="flex items-center gap-3"><button onclick="showMenu()" class="w-8 h-8 bg-slate-800 rounded-full flex items-center justify-center text-slate-400"><i class="fas fa-arrow-left text-xs"></i></button><p class="font-bebas text-2xl text-white">TU EQUIPO</p></div>
            <div class="bg-gradient-to-br from-slate-800 to-slate-900 p-6 rounded-2xl border border-white/5 text-center relative">
                <p class="text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1">Comisiones Acumuladas</p>
                <p class="text-4xl font-bebas text-yellow-400 gold-glow mb-4" id="team-balance">$0.0000</p>
                <button onclick="claimTeamEarnings()" class="w-full py-3 rounded-xl font-black text-[10px] uppercase bg-slate-700 text-slate-500 transition-all">PASAR AL SALDO PRINCIPAL</button>
            </div>
            <div class="bg-slate-900 p-4 rounded-2xl border border-white/5 space-y-3">
                <p class="text-[9px] font-bold text-slate-500 uppercase text-center">Tu Enlace de Referido</p>
                <div class="bg-black/30 p-2 rounded-lg border border-white/5"><p class="text-[9px] text-blue-400 font-mono truncate" id="invite-link">Cargando...</p></div>
                <button onclick="copyInvite()" class="w-full bg-blue-600/20 text-blue-400 border border-blue-500/30 py-2 rounded-lg font-bold text-[9px] uppercase">COPIAR ENLACE</button>
            </div>
        </div>

        <div id="view-mines" class="hidden space-y-4">
            <div class="flex items-center justify-between"><button onclick="showMenu()" class="w-8 h-8 bg-slate-800 rounded-full flex items-center justify-center text-slate-400"><i class="fas fa-arrow-left text-xs"></i></button><p class="font-bebas text-2xl text-red-500">MINAS</p><div class="w-8"></div></div>
            <div class="grid grid-cols-5 gap-2 w-full max-w-[280px] mx-auto p-2 bg-slate-900/50 rounded-2xl border border-white/5" id="mines-grid"></div>
            <div id="mines-controls" class="space-y-3">
                <div class="bg-slate-900 px-4 py-3 rounded-xl border border-white/5 flex items-center justify-between">
                    <span class="text-[10px] font-bold text-slate-400 uppercase">Minas</span>
                    <div class="flex items-center gap-3"><span class="font-bebas text-xl text-white w-4 text-center" id="bomb-count-display">3</span><input type="range" min="1" max="20" value="3" class="w-24 h-1 bg-slate-700 rounded-lg appearance-none accent-red-500" oninput="updateMinesCount(this.value)"></div>
                </div>
                <button onclick="startGameMines()" class="w-full py-4 bg-yellow-500 hover:bg-yellow-400 text-slate-900 rounded-xl font-black text-sm uppercase shadow-[0_0_15px_rgba(234,179,8,0.3)]">JUGAR</button>
            </div>
            <button id="mines-cashout" onclick="cashOutMines()" class="hidden w-full py-4 bg-emerald-500 text-white rounded-xl font-black text-sm uppercase shadow-[0_0_15px_rgba(16,185,129,0.3)]">RETIRAR GANANCIA</button>
        </div>

        <div id="view-coin" class="hidden space-y-6 text-center pt-8">
             <div class="flex items-center justify-between absolute top-4 left-4 right-4"><button onclick="showMenu()" class="w-8 h-8 bg-slate-800 rounded-full flex items-center justify-center text-slate-400"><i class="fas fa-arrow-left text-xs"></i></button><p class="font-bebas text-2xl text-blue-500">MONEDA</p><div class="w-8"></div></div>
            <div id="coin-display" class="w-32 h-32 mx-auto bg-slate-800 rounded-full flex items-center justify-center border-4 border-slate-700 shadow-2xl relative"><i class="fas fa-question text-5xl text-slate-500"></i></div>
            <div class="grid grid-cols-2 gap-4 w-full pt-4">
                <button onclick="playCoin('CARA')" class="py-4 bg-blue-600/20 border border-blue-500/50 text-blue-400 rounded-2xl font-black text-sm">CARA</button>
                <button onclick="playCoin('SOL')" class="py-4 bg-orange-600/20 border border-orange-500/50 text-orange-400 rounded-2xl font-black text-sm">SOL</button>
            </div>
        </div>

        <div id="bet-controls" class="hidden bg-slate-900 p-4 rounded-2xl border border-white/5 space-y-3 shadow-xl">
            <div class="flex justify-between items-end px-1"><span class="text-[9px] font-bold text-slate-500 uppercase tracking-widest">Apuesta</span><span class="text-xl font-bebas text-white" id="bet-display">$0.0010</span></div>
            <div class="grid grid-cols-3 gap-2">
                <button onclick="setBet('min')" class="py-2 bg-slate-800 rounded-lg font-bold text-[9px] text-slate-400 uppercase">MIN</button>
                <button onclick="setBet('x2')" class="py-2 bg-slate-800 rounded-lg font-bold text-[9px] text-yellow-500 uppercase">X2</button>
                <button onclick="setBet('half')" class="py-2 bg-slate-800 rounded-lg font-bold text-[9px] text-slate-400 uppercase">1/2</button>
            </div>
        </div>
            </div>
            <script>
    // --- DATOS DEL DUE√ëO Y CONFIGURACI√ìN ---
    const BOT_USERNAME = "FreCasino777_bot"; 
    const OWNER_USERNAME = "Aronleal"; // <--- AQU√ç EST√Å TU USUARIO PARA QUE TE LLEGUEN LOS MENSAJES

    // Configuraci√≥n para NO PERDER DINERO
    const C = { 
        MIN_WITHDRAW: 0.50, // M√≠nimo para retirar
        DAILY_REWARD: 0.01, // Bono diario
        VIDEO_REWARD: 0.002, // Lo que pagas por video
        COOLDOWN: 24*60*60*1000, // 24 horas exactas
        HOUSE_EDGE: 0.60 // La casa gana el 60% de las veces (Imposible perder dinero)
    };

    // --- VARIABLES DE USUARIO ---
    let savedData = localStorage.getItem('casino_biz_pro_v2');
    let parsedData = savedData ? JSON.parse(savedData) : {};
    let user = { 
        balance: parsedData.balance || 0.00, 
        teamEarnings: parsedData.teamEarnings || 0, 
        lastDaily: parsedData.lastDaily || 0, 
        videoTimers: parsedData.videoTimers || {}, 
        id: parsedData.id || 'ID' + Math.floor(Math.random() * 900000 + 100000)
    };

    // Detecci√≥n B√°sica de Multicuentas
    if(localStorage.getItem('casino_biz_pro_v2') && JSON.parse(localStorage.getItem('casino_biz_pro_v2')).id !== user.id) {
        alert("‚ö†Ô∏è Multicuenta detectada. Se bloquear√° el retiro.");
    }

    let currentBet = 0.001, minesCount = 3, isPlaying = false, minesGrid = [], multiplier = 1.0;
    const tg = window.Telegram.WebApp; tg.expand(); tg.setHeaderColor('#0f172a');
    saveData(); renderUI(); renderVideoButtons(); setInterval(updateTimers, 1000); updateTimers();

    // --- SONIDOS ---
    function playSound(t) {
        const s = { 'click': document.getElementById('snd-click'), 'win': document.getElementById('snd-win'), 'coin': document.getElementById('snd-coin') };
        if(s[t]) { s[t].currentTime = 0; s[t].play().catch(e=>{}); }
        if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred(t==='win'?'heavy':'light');
    }

    // --- L√ìGICA DE RETIRO (TICKET) ---
    function intentarRetiro() {
        playSound('click');
        if(user.balance >= C.MIN_WITHDRAW) {
            const now = new Date();
            const ticket = `üé´ TICKET DE RETIRO\n` +
                           `üìÖ Fecha: ${now.toLocaleDateString()} ${now.toLocaleTimeString()}\n` +
                           `üë§ Usuario ID: ${user.id}\n` +
                           `üí∞ Monto Retirado: $${user.balance.toFixed(4)}\n` +
                           `‚úÖ Estado: Verificando (Enviar Captura)`;
            
            tg.showConfirm("Se abrir√° el chat con @Aronleal. Env√≠a la captura del ticket. ¬øContinuar?", (ok) => {
                if(ok) {
                    user.balance = 0; // RESETEAR SALDO A 0
                    saveData(); renderUI();
                    const url = `https://t.me/${OWNER_USERNAME}?start=withdrawal&text=${encodeURIComponent(ticket)}`;
                    tg.openTelegramLink(url);
                }
            });
        } else {
            tg.showAlert(`‚ùå Saldo insuficiente.\nM√≠nimo: $${C.MIN_WITHDRAW.toFixed(2)}`);
        }
    }

    // --- L√ìGICA DE JUEGOS (MODO ANTI-P√âRDIDA) ---
    function playCoin(choice) {
        if(isPlaying) return; if(user.balance < currentBet) return tg.showAlert("Saldo insuficiente");
        playSound('click'); user.balance -= currentBet; isPlaying = true; renderUI(); 
        const d = document.getElementById('coin-display'); d.innerHTML = '<i class="fas fa-coins text-5xl text-yellow-500 animate-flip"></i>';
        
        setTimeout(() => {
            let result;
            const rand = Math.random();
            // TRUCO: La casa gana si rand < 0.60 (60% de las veces pierden)
            const houseWins = rand < C.HOUSE_EDGE; 
            
            if(houseWins) result = (choice === 'CARA' ? 'SOL' : 'CARA'); // Forzar p√©rdida
            else result = choice; // Dejar ganar (40% probabilidad)

            d.innerHTML = result === 'CARA' ? '<i class="fas fa-circle text-5xl text-blue-500 icon-glow"></i>' : '<i class="fas fa-sun text-5xl text-orange-500 icon-glow"></i>';
            if(choice === result) { 
                const prize = currentBet * 1.80; // Paga 1.8x (T√∫ te quedas el 20% extra)
                user.balance += prize; playSound('win'); tg.showAlert(`üèÜ ¬°GANASTE $${prize.toFixed(4)}!`);
            } else { tg.showAlert("‚ùå Perdiste..."); }
            isPlaying = false; saveData(); renderUI();
        }, 1500);
    }

    function clickMine(idx) {
        if(!isPlaying || minesGrid[idx] === 'clicked') return; playSound('click');
        if(minesGrid[idx] === 'mine') { renderMinesGrid(true); gameOver(false); } 
        else { 
            minesGrid[idx] = 'clicked'; 
            multiplier += (minesCount * 0.02); // Multiplicador bajo para proteger tu dinero
            renderMinesGrid(false); document.getElementById('mines-cashout').innerText = `RETIRAR $${(currentBet * multiplier).toFixed(4)}`; 
        }
    }

    // --- FUNCIONES CORE ---
    function renderVideoButtons() {
        const g = document.getElementById('video-grid'); g.innerHTML = ''; const now = Date.now();
        for(let i=1; i<=8; i++) {
            const btn = document.createElement('button');
            const lastView = user.videoTimers[`v${i}`] || 0; const diff = C.COOLDOWN - (now - lastView); const isLocked = diff > 0;
            btn.className = `h-10 rounded-lg font-bold text-[10px] flex items-center justify-center border transition-all ${isLocked ? 'bg-slate-800 text-slate-500 border-transparent locked' : 'bg-slate-700 text-white border-white/10 hover:bg-blue-600'}`;
            if(isLocked) { const h = Math.floor(diff/3600000), m = Math.floor((diff%3600000)/60000); btn.innerHTML = `<i class="fas fa-lock"></i> ${h}h ${m}m`; } 
            else { btn.innerHTML = `<i class="fas fa-play"></i> VIDEO ${i}`; btn.onclick = () => watchVideo(i); } g.appendChild(btn);
        }
    }
    function watchVideo(id) { playSound('click'); if(typeof show_88_tag !== 'undefined') { show_88_tag().then(() => finishVideo(id)).catch(() => finishVideo(id)); } else setTimeout(() => finishVideo(id), 1500); }
    function finishVideo(id) { playSound('coin'); user.balance += C.VIDEO_REWARD; user.videoTimers[`v${id}`] = Date.now(); saveData(); renderUI(); renderVideoButtons(); tg.showAlert(`‚úÖ ¬°Ganaste $${C.VIDEO_REWARD}!`); }
    function claimDailyBonus() { const now = Date.now(); if(now - user.lastDaily < C.COOLDOWN) return tg.showAlert("Vuelve ma√±ana"); user.balance += C.DAILY_REWARD; user.lastDaily = now; saveData(); renderUI(); playSound('coin'); tg.showAlert("Bono Recibido"); }
    
    // Core Game & UI
    function openGame(g) { showScreen(g === 'mines' ? 'view-mines' : 'view-coin'); setBet('min'); }
    function openTeam() { showScreen('view-team'); updateTeamUI(); }
    function showMenu() { ['view-team', 'view-mines', 'view-coin', 'bet-controls'].forEach(id => document.getElementById(id).classList.add('hidden')); document.getElementById('view-menu').classList.remove('hidden'); isPlaying = false; }
    function showScreen(id) { document.getElementById('view-menu').classList.add('hidden'); document.getElementById(id).classList.remove('hidden'); if(id.includes('mines') || id.includes('coin')) document.getElementById('bet-controls').classList.remove('hidden'); }
    function updateMinesCount(v) { if(!isPlaying) { minesCount = parseInt(v); document.getElementById('bomb-count-display').innerText = minesCount; } }
    function startGameMines() { if(user.balance < currentBet) return tg.showAlert("Saldo insuficiente"); playSound('click'); user.balance -= currentBet; isPlaying = true; multiplier = 1.0; minesGrid = Array(25).fill('safe'); let placed = 0; while(placed < minesCount) { let idx = Math.floor(Math.random() * 25); if(minesGrid[idx] === 'safe') { minesGrid[idx] = 'mine'; placed++; } } renderMinesGrid(false); document.getElementById('mines-controls').classList.add('hidden'); document.getElementById('mines-cashout').classList.remove('hidden'); saveData(); renderUI(); }
    function renderMinesGrid(rev) { const g = document.getElementById('mines-grid'); g.innerHTML = ''; minesGrid.forEach((v, i) => { const b = document.createElement('button'); b.className = "w-12 h-12 bg-slate-800 rounded-lg flex items-center justify-center border border-white/5 active:scale-95 transition-all shadow-md"; if(rev) { b.innerHTML = (v === 'mine') ? '<i class="fas fa-bomb text-red-500"></i>' : '<i class="fas fa-gem text-emerald-400 opacity-30"></i>'; } else if (v === 'clicked') { b.className = "w-12 h-12 bg-emerald-900/50 rounded-lg border-emerald-500/50"; b.innerHTML = '<i class="fas fa-gem text-emerald-400 text-xl icon-glow"></i>'; } else { b.onclick = () => clickMine(i); } g.appendChild(b); }); }
    function cashOutMines() { if(!isPlaying) return; const win = currentBet * multiplier; user.balance += win; playSound('win'); tg.showAlert(`Ganaste $${win.toFixed(4)}`); gameOver(true); }
    function gameOver(w) { isPlaying = false; saveData(); renderUI(); document.getElementById('mines-controls').classList.remove('hidden'); document.getElementById('mines-cashout').classList.add('hidden'); }
    function updateTeamUI() { document.getElementById('invite-link').innerText = `https://t.me/${BOT_USERNAME}?start=ref_${user.id}`; document.getElementById('team-balance').innerText = '$' + user.teamEarnings.toFixed(4); }
    function claimTeamEarnings() { if(user.teamEarnings > 0) { user.balance += user.teamEarnings; user.teamEarnings = 0; saveData(); renderUI(); updateTeamUI(); playSound('coin'); } else tg.showAlert("No tienes ganancias."); }
    function copyInvite() { navigator.clipboard.writeText(`https://t.me/${BOT_USERNAME}?start=ref_${user.id}`); tg.showAlert("Enlace copiado"); }
    function updateTimers() { const diff = C.COOLDOWN - (Date.now() - user.lastDaily); const txt = document.getElementById('daily-text'); if(diff <= 0) { txt.innerText = "¬°DISPONIBLE!"; txt.classList.add('text-yellow-400'); } else { const h = Math.floor(diff/3600000), m = Math.floor((diff%3600000)/60000); txt.innerText = `${h}h ${m}m`; txt.classList.remove('text-yellow-400'); } if(Date.now() % 5000 < 1000) renderVideoButtons(); }
    function setBet(t) { if(isPlaying) return; playSound('click'); if(t==='min') currentBet=0.001; if(t==='x2') currentBet*=2; if(t==='half') currentBet/=2; if(currentBet>user.balance) currentBet=user.balance; renderUI(); }
    function saveData() { localStorage.setItem('casino_biz_pro_v2', JSON.stringify(user)); }
    function renderUI() { document.getElementById('display-balance').innerText = '$' + user.balance.toFixed(4); document.getElementById('bet-display').innerText = '$' + currentBet.toFixed(4); let pct = (user.balance/C.MIN_WITHDRAW)*100; if(pct>100)pct=100; document.getElementById('progress-bar').style.width = pct+'%'; document.getElementById('min-withdraw-display').innerText = C.MIN_WITHDRAW.toFixed(2); }
</script>
</body>
</html>
