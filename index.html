<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Decorador de Textos âœ¨</title>
    
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        body {
            margin: 0; padding: 20px;
            background: #fdf2f8; /* Fondo rosita muy suave */
            font-family: 'Poppins', sans-serif;
            display: flex; flex-direction: column; align-items: center;
            color: #4a4a4a;
        }
        .container { width: 100%; max-width: 400px; }
        
        h1 { 
            font-size: 24px; color: #db2777; text-align: center; margin-bottom: 5px; 
            font-weight: 600;
        }
        p { 
            text-align: center; color: #831843; font-size: 13px; margin-bottom: 25px; 
            line-height: 1.5; background: #fce7f3; padding: 10px; border-radius: 10px;
        }

        textarea {
            width: 100%; height: 120px;
            border: 2px solid #fbcfe8; border-radius: 15px;
            padding: 15px; font-family: inherit; font-size: 15px;
            box-sizing: border-box; outline: none; resize: none;
            background: #fff; color: #333;
            transition: 0.3s;
        }
        textarea:focus { border-color: #db2777; box-shadow: 0 0 10px rgba(219, 39, 119, 0.2); }

        .btn-magic {
            background: linear-gradient(135deg, #db2777, #ec4899);
            color: white; border: none; padding: 16px;
            width: 100%; border-radius: 12px;
            font-weight: 600; font-size: 16px; cursor: pointer;
            margin-top: 20px; box-shadow: 0 4px 15px rgba(219, 39, 119, 0.3);
            display: flex; align-items: center; justify-content: center; gap: 10px;
            transition: transform 0.2s;
        }
        .btn-magic:active { transform: scale(0.97); }

        /* RESULTADO */
        .result-box {
            background: white; padding: 20px;
            border-radius: 15px; margin-top: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            display: none; border: 1px solid #fce7f3;
        }
        
        .preview {
            white-space: pre-wrap;
            font-size: 15px; color: #333; line-height: 1.6;
        }

        .actions { display: flex; gap: 10px; margin-top: 20px; }
        .btn-copy {
            flex: 1; background: #10b981; color: white;
            border: none; padding: 12px; border-radius: 10px; font-weight: 600; cursor: pointer;
            box-shadow: 0 3px 10px rgba(16, 185, 129, 0.2);
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>âœ¨ Editor MÃ¡gico âœ¨</h1>
        <p>
            Transforma tus mensajes aburridos en textos profesionales. 
            Agregamos emojis, organizamos la informaciÃ³n y corregimos errores comunes para que tus ventas destaquen. ðŸš€
        </p>

        <textarea id="inputText" placeholder="Escribe aquÃ­ tu texto...
Ej: vendo telefono xq necesito plata el presio es barato"></textarea>

        <button class="btn-magic" onclick="transformarTexto()">
            <span>ðŸª„</span> DECORAR TEXTO
        </button>

        <div id="result-box" class="result-box">
            <div class="preview" id="outputText"></div>
            
            <div class="actions">
                <button class="btn-copy" onclick="copiar()">ðŸ“‹ Copiar Texto</button>
                <button class="btn-copy" style="background:#f3f4f6; color:#555" onclick="location.reload()">ðŸ”„ Nuevo</button>
            </div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        const ADSGRAM_ID = "18897"; 

        function transformarTexto() {
            let texto = document.getElementById('inputText').value;
            if(!texto) return tg.showAlert("Escribe algo primero");

            // EL COBRO: ANTES DE MOSTRAR LA MAGIA ðŸ’°
            try {
                window.Adsgram.init({ blockId: ADSGRAM_ID }).show().then(() => {
                    procesarMagia(texto);
                }).catch(() => {
                    procesarMagia(texto);
                });
            } catch(e) {
                procesarMagia(texto);
            }
        }

        function procesarMagia(texto) {
            // 1. CORRECCIÃ“N ORTOGRÃFICA BÃSICA (Diccionario de errores comunes)
            let corregido = correccionBasica(texto);

            // 2. DIVIDIR POR LÃNEAS
            let lineas = corregido.split('\n');
            let resultado = "";

            // 3. EMOJIS (Diccionario mejorado)
            const emojis = {
                "precio": "ðŸ’²", "costo": "ðŸ’²", "valor": "ðŸ’²", "dolares": "ðŸ‡ºðŸ‡¸", "bs": "ðŸ‡»ðŸ‡ª", 
                "oferta": "ðŸ”¥", "remate": "ðŸ”¥", "vendo": "ðŸ›ï¸", "disponible": "âœ…",
                "envio": "ðŸšš", "delivery": "ðŸ›µ", "gratis": "ðŸŽ", 
                "info": "â„¹ï¸", "informacion": "â„¹ï¸", "detalles": "ðŸ“",
                "talla": "ðŸ“", "medida": "ðŸ“", "color": "ðŸŽ¨",
                "celular": "ðŸ“±", "telefono": "ðŸ“±", "iphone": "ðŸŽ", "android": "ðŸ¤–",
                "nuevo": "âœ¨", "usado": "ðŸ‘", "garantia": "ðŸ›¡ï¸",
                "ubicacion": "ðŸ“", "caracas": "ðŸ™ï¸", "venezuela": "ðŸ‡»ðŸ‡ª",
                "contacto": "ðŸ“ž", "whatsapp": "ðŸ“²", "dm": "ðŸ“©", "privado": "ðŸ“©",
                "pago": "ðŸ’³", "zelle": "ðŸŸ£", "binance": "ðŸ”¶", "efectivo": "ðŸ’µ"
            };

            // PROCESAR PRIMERA LÃNEA (TÃTULO - Sin negrita, solo mayÃºscula y emojis)
            if(lineas.length > 0) {
                let titulo = lineas[0].toUpperCase().trim();
                resultado += "âœ¨ " + titulo + " âœ¨\n\n";
            }

            // PROCESAR EL RESTO
            for(let i=1; i < lineas.length; i++) {
                let linea = lineas[i].trim();
                if(linea === "") {
                    resultado += "\n";
                    continue;
                }

                // Buscar emoji adecuado para la lÃ­nea
                let emojiLinea = "ðŸ‘‰"; // Emoji por defecto
                let palabras = linea.toLowerCase().split(' ');
                
                for(let p of palabras) {
                    // Limpiar puntuaciÃ³n de la palabra para comparar
                    let limpia = p.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"");
                    if(emojis[limpia]) {
                        emojiLinea = emojis[limpia];
                        break;
                    }
                }
                
                // Capitalizar primera letra de la lÃ­nea
                let lineaBonita = linea.charAt(0).toUpperCase() + linea.slice(1);
                
                resultado += `${emojiLinea} ${lineaBonita}\n`;
            }

            // PIE DE PÃGINA (Footer)
            resultado += "\nâž–âž–âž–âž–âž–âž–âž–âž–âž–âž–\n";
            resultado += "ðŸ“© Â¡Responde para mÃ¡s info!";

            // MOSTRAR
            document.getElementById('outputText').innerText = resultado;
            document.getElementById('result-box').style.display = 'block';
            document.querySelector('.btn-magic').style.display = 'none';
        }

        function correccionBasica(txt) {
            // Diccionario de reemplazos (Errores comunes en chat)
            // Usamos expresiones regulares para reemplazar solo palabras completas
            const errores = [
                { mal: "\\bq\\b", bien: "que" },
                { mal: "\\bxq\\b", bien: "porque" },
                { mal: "\\bporq\\b", bien: "porque" },
                { mal: "\\bx\\b", bien: "por" },
                { mal: "\\bd\\b", bien: "de" },
                { mal: "\\bbn\\b", bien: "bien" },
                { mal: "\\bpresio\\b", bien: "precio" },
                { mal: "\\bprcio\\b", bien: "precio" },
                { mal: "\\binteresado\\b", bien: "interesados" },
                { mal: "\\binfo\\b", bien: "informaciÃ³n" },
                { mal: "\\bubi\\b", bien: "ubicaciÃ³n" },
                { mal: "\\btlf\\b", bien: "telÃ©fono" },
                { mal: "\\bnum\\b", bien: "nÃºmero" },
                { mal: "\\bgrasias\\b", bien: "gracias" },
                { mal: "\\bhol\\b", bien: "hola" },
                { mal: "\\bvend\\b", bien: "vendo" }
            ];

            let textoCorregido = txt;
            errores.forEach(item => {
                let regex = new RegExp(item.mal, "gi"); // g=global, i=mayus/minus
                textoCorregido = textoCorregido.replace(regex, item.bien);
            });

            return textoCorregido;
        }

        function copiar() {
            let txt = document.getElementById('outputText').innerText;
            navigator.clipboard.writeText(txt);
            tg.showAlert("Â¡Texto copiado!");
        }
    </script>
</body>
</html>
