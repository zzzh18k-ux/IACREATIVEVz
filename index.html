<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Casino 777 Free</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src='//libtl.com/sdk.js' data-zone='10278425' data-sdk='show_10278425'></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; background-color: #020617; color: white; -webkit-tap-highlight-color: transparent; user-select: none; }
        .font-bebas { font-family: 'Bebas Neue', cursive; }
        .hidden { display: none !important; }
        /* Animaciones */
        @keyframes bounce-subtle { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        .animate-bounce-custom { animation: bounce-subtle 2s ease-in-out infinite; }
    </style>
</head>
<body class="bg-slate-950 pb-32">

    <div class="p-6 bg-slate-900/80 backdrop-blur-lg sticky top-0 z-50 border-b border-white/5 flex flex-col gap-4 shadow-2xl">
        <div class="flex justify-between items-center">
            <div>
                <p class="text-[10px] text-slate-500 font-black uppercase">Balance USDT</p>
                <p class="text-3xl font-black text-yellow-500 font-bebas" id="display-balance">$0.1000</p>
            </div>
            <button onclick="intentarRetiro()" class="px-4 py-2 rounded-xl font-black text-xs uppercase bg-slate-800 text-slate-500 transition-all" id="btn-withdraw">Retirar</button>
        </div>
        <div class="bg-slate-800/50 rounded-full h-6 relative overflow-hidden border border-white/5 p-1">
            <div id="progress-bar" class="h-full rounded-full bg-gradient-to-r from-orange-500 to-yellow-500 transition-all duration-500" style="width: 50%"></div>
            <div class="absolute inset-0 flex items-center justify-center text-[9px] font-black uppercase tracking-widest text-white drop-shadow-md">
                Meta: $<span id="prog-val">0.10</span> / $0.20
            </div>
        </div>
    </div>
    <div class="px-6 py-4 max-w-md mx-auto">
        <div id="game-msg" class="hidden p-4 rounded-2xl text-center font-black mb-4 border-2 animate-pulse bg-emerald-500/10 border-emerald-500 text-emerald-400">
            ¬°Ganaste!
        </div>

        <div id="view-menu" class="space-y-4">
            <button onclick="claimDailyBonus()" id="btn-daily" class="w-full p-6 rounded-3xl flex items-center justify-between border-2 shadow-2xl bg-gradient-to-r from-yellow-500 to-orange-500 border-yellow-400">
                <div>
                    <p class="font-black uppercase text-sm text-slate-950">Bono Diario</p>
                    <p class="font-bebas text-3xl text-white" id="daily-text">$0.005 USDT</p>
                </div>
                <div class="text-5xl">üéÅ</div>
            </button>

            <h2 class="font-bebas text-2xl text-slate-400 tracking-widest pt-4">JUEGOS</h2>
            
            <button onclick="openGame('mines')" class="w-full h-32 bg-gradient-to-br from-red-500 to-orange-600 rounded-3xl flex items-center justify-between px-8 shadow-xl active:scale-95 transition-transform">
                <div class="text-left"><p class="font-bebas text-5xl">MINAS</p><p class="text-[10px] font-bold opacity-70 uppercase">Multiplicador</p></div>
                <span class="text-6xl">üí£</span>
            </button>
            
            <button onclick="openGame('coin')" class="w-full h-32 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-3xl flex items-center justify-between px-8 shadow-xl active:scale-95 transition-transform">
                <div class="text-left"><p class="font-bebas text-5xl">MONEDA</p><p class="text-[10px] font-bold opacity-70 uppercase">Doble o Nada</p></div>
                <span class="text-6xl">ü™ô</span>
            </button>
        </div>

        <div id="view-mines" class="hidden space-y-6">
            <div class="flex justify-between items-center">
                <button onclick="showMenu()" class="w-10 h-10 bg-white/5 rounded-full flex items-center justify-center"><i class="fas fa-arrow-left"></i></button>
                <p class="font-bebas text-3xl text-yellow-500 tracking-widest">MINAS</p>
                <div class="w-10"></div>
            </div>
            
            <div class="grid grid-cols-5 gap-2 w-full max-w-[320px] mx-auto" id="mines-grid">
                </div>

            <div id="mines-controls" class="space-y-4">
                <div class="bg-slate-900 p-4 rounded-2xl border border-white/5">
                    <span class="text-[10px] font-black text-slate-500 uppercase">Bombas: <span id="bomb-count-display">3</span></span>
                    <input type="range" min="1" max="24" value="3" class="w-full h-2 bg-slate-800 rounded-lg appearance-none accent-yellow-500" oninput="updateMinesCount(this.value)">
                </div>
                <button onclick="startGameMines()" class="w-full py-5 bg-yellow-500 text-slate-950 rounded-3xl font-black text-xl shadow-xl active:scale-95">JUGAR</button>
            </div>
            <button id="mines-cashout" onclick="cashOutMines()" class="hidden w-full py-5 bg-emerald-500 rounded-3xl font-black text-xl shadow-lg active:scale-95">RETIRAR</button>
        </div>

        <div id="view-coin" class="hidden space-y-6 text-center">
             <div class="flex justify-between items-center mb-10">
                <button onclick="showMenu()" class="w-10 h-10 bg-white/5 rounded-full flex items-center justify-center"><i class="fas fa-arrow-left"></i></button>
                <p class="font-bebas text-3xl text-yellow-500 tracking-widest">MONEDA</p>
                <div class="w-10"></div>
            </div>
            <div id="coin-display" class="text-9xl transition-all duration-500">ü™ô</div>
            <div class="flex gap-4 w-full pt-10">
                <button onclick="playCoin('CARA')" class="flex-1 py-5 bg-blue-600 rounded-3xl font-black text-lg active:scale-95 shadow-lg">CARA</button>
                <button onclick="playCoin('SOL')" class="flex-1 py-5 bg-orange-600 rounded-3xl font-black text-lg active:scale-95 shadow-lg">SOL</button>
            </div>
        </div>

        <div id="bet-controls" class="hidden bg-slate-900 p-6 rounded-3xl border border-white/5 space-y-4 shadow-xl mt-6">
            <div class="flex justify-between items-end px-2">
                <span class="text-[10px] font-black text-slate-500 uppercase">Apuesta</span>
                <span class="text-2xl font-bebas text-white" id="bet-display">$0.0010</span>
            </div>
            <div class="grid grid-cols-3 gap-2">
                <button onclick="setBet('min')" class="py-3 bg-slate-800 rounded-xl font-bold text-[10px] uppercase">MIN</button>
                <button onclick="setBet('x2')" class="py-3 bg-slate-800 rounded-xl font-bold text-[10px] uppercase text-yellow-500">X2</button>
                <button onclick="setBet('half')" class="py-3 bg-slate-800 rounded-xl font-bold text-[10px] uppercase">1/2</button>
            </div>
        </div>
                    </div>
                    <script>
    // --- VARIABLES Y DATOS ---
    let user = { balance: 0.10, lastDaily: 0 };
    const CONSTANTS = { MIN_BET: 0.001, WITHDRAW_LIMIT: 0.20, DAILY_REWARD: 0.005 };
    let currentBet = 0.001;
    let minesCount = 3;
    let isPlaying = false;
    let minesGrid = []; // Array para el juego
    let multiplier = 1.0;

    // Inicializar App
    const tg = window.Telegram.WebApp;
    tg.expand();
    loadData();
    renderUI();

    // --- FUNCIONES DE INTERFAZ ---
    function showMenu() {
        document.getElementById('view-menu').classList.remove('hidden');
        document.getElementById('view-mines').classList.add('hidden');
        document.getElementById('view-coin').classList.add('hidden');
        document.getElementById('bet-controls').classList.add('hidden');
        document.getElementById('game-msg').classList.add('hidden');
    }

    function openGame(game) {
        document.getElementById('view-menu').classList.add('hidden');
        document.getElementById('bet-controls').classList.remove('hidden');
        document.getElementById('game-msg').classList.add('hidden');
        
        if(game === 'mines') {
            document.getElementById('view-mines').classList.remove('hidden');
            initMinesGrid(); // Dibuja la cuadr√≠cula vac√≠a
        } else {
            document.getElementById('view-coin').classList.remove('hidden');
        }
    }

    function renderUI() {
        // Actualizar textos
        document.getElementById('display-balance').innerText = '$' + user.balance.toFixed(4);
        document.getElementById('prog-val').innerText = user.balance.toFixed(2);
        document.getElementById('bet-display').innerText = '$' + currentBet.toFixed(4);
        
        // Barra de progreso
        let pct = (user.balance / CONSTANTS.WITHDRAW_LIMIT) * 100;
        if(pct > 100) pct = 100;
        document.getElementById('progress-bar').style.width = pct + '%';
        
        // Bot√≥n retiro
        const btnW = document.getElementById('btn-withdraw');
        if(user.balance >= CONSTANTS.WITHDRAW_LIMIT) {
            btnW.classList.remove('bg-slate-800', 'text-slate-500');
            btnW.classList.add('bg-emerald-500', 'text-white', 'animate-pulse');
        }

        // Timer Bono Diario
        const now = Date.now();
        const diff = (user.lastDaily + 86400000) - now;
        const btnD = document.getElementById('btn-daily');
        const txtD = document.getElementById('daily-text');
        
        if(diff > 0) {
            let h = Math.floor(diff/3600000);
            let m = Math.floor((diff%3600000)/60000);
            txtD.innerText = `Espera ${h}h ${m}m`;
            txtD.classList.add('text-slate-500');
            btnD.classList.add('opacity-50', 'pointer-events-none');
            btnD.classList.remove('animate-pulse');
        } else {
            txtD.innerText = `$${CONSTANTS.DAILY_REWARD} USDT`;
            txtD.classList.remove('text-slate-500');
            btnD.classList.remove('opacity-50', 'pointer-events-none');
            btnD.classList.add('animate-pulse');
        }
    }

    // --- L√ìGICA DEL JUEGO ---
    function setBet(type) {
        if(type === 'min') currentBet = CONSTANTS.MIN_BET;
        if(type === 'x2') currentBet = Math.min(user.balance, currentBet * 2);
        if(type === 'half') currentBet = Math.max(CONSTANTS.MIN_BET, currentBet / 2);
        renderUI();
    }

    // JUEGO: MINAS
    function updateMinesCount(val) {
        minesCount = parseInt(val);
        document.getElementById('bomb-count-display').innerText = minesCount;
    }

    function initMinesGrid() {
        const grid = document.getElementById('mines-grid');
        grid.innerHTML = '';
        minesGrid = Array(25).fill('empty'); // Reiniciar l√≥gica
        document.getElementById('mines-controls').classList.remove('hidden');
        document.getElementById('mines-cashout').classList.add('hidden');
        
        for(let i=0; i<25; i++) {
            const tile = document.createElement('div');
            tile.className = "aspect-square bg-slate-700 rounded-xl flex items-center justify-center text-2xl shadow-lg border border-white/5 cursor-pointer active:scale-95 transition-all";
            tile.id = `tile-${i}`;
            tile.onclick = () => clickTile(i);
            grid.appendChild(tile);
        }
    }

    function startGameMines() {
        if(user.balance < currentBet) return alert("Saldo insuficiente");
        
        user.balance -= currentBet;
        isPlaying = true;
        multiplier = 1.0;
        
        // Colocar bombas aleatorias
        minesGrid.fill('gem');
        let placed = 0;
        while(placed < minesCount) {
            let r = Math.floor(Math.random() * 25);
            if(minesGrid[r] !== 'bomb') {
                minesGrid[r] = 'bomb';
                placed++;
            }
        }

        document.getElementById('mines-controls').classList.add('hidden');
        document.getElementById('mines-cashout').classList.remove('hidden');
        saveData();
        renderUI();
    }

    function clickTile(idx) {
        if(!isPlaying) return;
        const tile = document.getElementById(`tile-${idx}`);
        
        if(tile.classList.contains('bg-slate-800')) return; // Ya revelado

        if(minesGrid[idx] === 'bomb') {
            // PERDISTE
            tile.innerHTML = 'üí£';
            tile.classList.replace('bg-slate-700', 'bg-red-500');
            gameOver(false, "¬°BOOM! Perdiste");
        } else {
            // GANASTE GEMA
            tile.innerHTML = 'üíé';
            tile.classList.replace('bg-slate-700', 'bg-slate-800');
            // Calcular nuevo multiplicador (simplificado)
            multiplier += 0.2; 
            document.getElementById('mines-cashout').innerText = `RETIRAR $${(currentBet * multiplier).toFixed(4)}`;
        }
    }

    function cashOutMines() {
        if(!isPlaying) return;
        const winAmount = currentBet * multiplier;
        user.balance += winAmount;
        gameOver(true, `Ganaste $${winAmount.toFixed(4)}`);
    }

    // JUEGO: MONEDA
    function playCoin(choice) {
        if(user.balance < currentBet) return alert("Saldo insuficiente");
        user.balance -= currentBet;
        renderUI();

        const display = document.getElementById('coin-display');
        display.classList.add('animate-bounce-custom');
        display.innerText = '‚ùì';

        setTimeout(() => {
            const isHeads = Math.random() > 0.5;
            const result = isHeads ? 'CARA' : 'SOL';
            display.classList.remove('animate-bounce-custom');
            display.innerText = result === 'CARA' ? 'ü™ô' : '‚òÄÔ∏è';

            if(choice === result) {
                const win = currentBet * 1.95;
                user.balance += win;
                gameOver(true, `¬°${result}! Ganaste $${win.toFixed(4)}`);
            } else {
                gameOver(false, `¬°${result}! Perdiste`);
            }
        }, 1000);
    }

    // SISTEMA GENERAL
    function gameOver(win, msg) {
        isPlaying = false;
        saveData();
        renderUI();
        const el = document.getElementById('game-msg');
        el.innerText = msg;
        el.classList.remove('hidden');
        if(win) {
            el.className = "p-4 rounded-2xl text-center font-black mb-4 border-2 bg-emerald-500/10 border-emerald-500 text-emerald-400";
            if(window.Telegram.WebApp.HapticFeedback) window.Telegram.WebApp.HapticFeedback.notificationOccurred('success');
        } else {
            el.className = "p-4 rounded-2xl text-center font-black mb-4 border-2 bg-red-500/10 border-red-500 text-red-400";
            if(window.Telegram.WebApp.HapticFeedback) window.Telegram.WebApp.HapticFeedback.notificationOccurred('error');
            // Mostrar grid completo en minas
            if(minesGrid.length > 0) {
                 minesGrid.forEach((val, i) => {
                     if(val === 'bomb') document.getElementById(`tile-${i}`).innerHTML = 'üí£';
                 });
            }
        }
        
        // Resetear UI de Minas
        document.getElementById('mines-cashout').classList.add('hidden');
        // Esperar un poco y mostrar controles de nuevo
        setTimeout(() => {
            if(!document.getElementById('view-mines').classList.contains('hidden')) {
                document.getElementById('mines-controls').classList.remove('hidden');
            }
        }, 1500);
    }

    function claimDailyBonus() {
        // Simular anuncio y recompensa
        user.balance += CONSTANTS.DAILY_REWARD;
        user.lastDaily = Date.now();
        saveData();
        renderUI();
        alert("¬°Bono Diario Recibido!");
    }

    function intentarRetiro() {
        if(user.balance >= CONSTANTS.WITHDRAW_LIMIT) {
            alert("¬°Felicidades! Captura esta pantalla y env√≠ala al soporte para tu pago.");
            // Aqu√≠ podr√≠as redirigir al bot
        } else {
            alert(`Necesitas llegar a $${CONSTANTS.WITHDRAW_LIMIT} USDT`);
        }
    }

    // Guardado local
    function loadData() {
        const saved = localStorage.getItem('casino777_v2');
        if(saved) user = JSON.parse(saved);
    }
    function saveData() {
        localStorage.setItem('casino777_v2', JSON.stringify(user));
    }
</script>
</body>
</html>
